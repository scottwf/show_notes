version: '3.8'

services:
  shownotes:
    build: .
    container_name: shownotes
    ports:
      - "5001:5001"
    environment:
      # Plex OAuth Configuration
      - PLEX_CLIENT_ID=${PLEX_CLIENT_ID:-shownotes-docker}
      - PLEX_APP_URL=${PLEX_APP_URL:-http://localhost:5001}
      
      # Optional: Service configurations (can also be set via admin panel)
      - SONARR_URL=${SONARR_URL}
      - SONARR_API_KEY=${SONARR_API_KEY}
      - RADARR_URL=${RADARR_URL}
      - RADARR_API_KEY=${RADARR_API_KEY}
      - BAZARR_URL=${BAZARR_URL}
      - BAZARR_API_KEY=${BAZARR_API_KEY}
      - OLLAMA_API_URL=${OLLAMA_API_URL}
      - PUSHOVER_API_TOKEN=${PUSHOVER_API_TOKEN}
      - PUSHOVER_USER_KEY=${PUSHOVER_USER_KEY}
    volumes:
      # Persist database and uploads
      - shownotes-data:/app/instance
      - shownotes-logs:/app/logs
      - shownotes-static:/app/app/static/poster
      - shownotes-backgrounds:/app/app/static/background
    restart: unless-stopped
    networks:
      - shownotes-net

  # Optional: Ollama service for local LLM (uncomment if needed)
  # ollama:
  #   image: ollama/ollama:latest
  #   container_name: shownotes-ollama
  #   ports:
  #     - "11434:11434"
  #   volumes:
  #     - ollama-data:/root/.ollama
  #   restart: unless-stopped
  #   networks:
  #     - shownotes-net

volumes:
  shownotes-data:
    driver: local
  shownotes-logs:
    driver: local
  shownotes-static:
    driver: local
  shownotes-backgrounds:
    driver: local
  # ollama-data:
  #   driver: local

networks:
  shownotes-net:
    driver: bridge
