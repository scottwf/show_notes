{% extends "admin_layout.html" %}

{% block admin_page_title %}Test LLM Summary{% endblock %}

{% block admin_page_header %}Test LLM Summary Generation{% endblock %}

{% block admin_page_content %}
<div class="space-y-6">
    <div class="bg-white dark:bg-slate-800 shadow-lg rounded-sm border border-slate-200 dark:border-slate-700 p-4 sm:p-6">
        <h2 class="text-xl font-semibold text-slate-800 dark:text-slate-100 mb-1">Test Parameters</h2>
        <p class="text-sm text-slate-600 dark:text-slate-400">Character: <span class="font-medium">{{ test_character }}</span></p>
        <p class="text-sm text-slate-600 dark:text-slate-400">Show: <span class="font-medium">{{ test_show }}</span></p>
        <p class="text-sm text-slate-600 dark:text-slate-400">Season: <span class="font-medium">{{ test_season }}</span></p>
        <p class="text-sm text-slate-600 dark:text-slate-400">Episode: <span class="font-medium">{{ test_episode }}</span></p>
        <p class="text-sm text-slate-600 dark:text-slate-400">Preferred LLM Provider: <span class="font-medium">{{ preferred_provider }}</span></p>
        <div class="mt-2">
            <p class="text-sm text-slate-600 dark:text-slate-400 mb-1">Prompt Options Used:</p>
            <pre class="text-xs bg-slate-100 dark:bg-slate-700 p-2 rounded mt-1 whitespace-pre-wrap">{{ prompt_options | tojson(indent=2) }}</pre>
        </div>

        <h3 class="text-lg font-semibold text-slate-800 dark:text-slate-100 mt-4 mb-2">Generated Prompt:</h3>
        <pre class="text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap p-3 bg-slate-100 dark:bg-slate-900 rounded max-h-80 overflow-y-auto">{{ generated_prompt }}</pre>
    </div>

    <div class="bg-white dark:bg-slate-800 shadow-lg rounded-sm border border-slate-200 dark:border-slate-700 p-4 sm:p-6">
        <h3 class="text-lg font-semibold text-slate-800 dark:text-slate-100 mb-2">LLM Response:</h3>
        {% if error_message %}
            <div class="p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg dark:bg-red-800/30 border border-red-300 dark:border-red-700" role="alert">
                <span class="font-medium">Error:</span> {{ error_message }}
            </div>
        {% endif %}
        {% if llm_response %}
            <pre class="text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap p-3 bg-slate-100 dark:bg-slate-900 rounded max-h-[500px] overflow-y-auto">{{ llm_response }}</pre>
        {% elif not error_message %}
            <p class="text-slate-500 dark:text-slate-400">No response received from LLM (and no error reported). This might mean the provider is not configured, returned an empty response, or "None" is selected as the provider.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
